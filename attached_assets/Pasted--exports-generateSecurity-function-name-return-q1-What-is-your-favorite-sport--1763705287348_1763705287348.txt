
exports.generateSecurity = function(name) {
  return {
    q1: "What is your favorite sport?",
    a1: name + "Sport",

    q2: "What is your dream job?",
    a2: name + "Job",

    q3: "What is your favorite food?",
    a3: name + "Food",
  };
};



const fs = require("fs");
const dbFile = "./db.json";

function loadDB() {
  return JSON.parse(fs.readFileSync(dbFile));
}
function saveDB(db) {
  fs.writeFileSync(dbFile, JSON.stringify(db, null, 2));
}
------------ÙØ§ÛŒÙ„ security.js
exports.pickGiftCard = function() {
  const db = loadDB();
  const card = db.gifts.shift();
  saveDB(db);
  return card || null;
};




ÙØ§ÛŒÙ„manager.js

const fs = require("fs");
const dbFile = "./db.json";

function loadDB() {
  return JSON.parse(fs.readFileSync(dbFile));
}
function saveDB(db) {
  fs.writeFileSync(dbFile, JSON.stringify(db, null, 2));
}

exports.pickGiftCard = function() {
  const db = loadDB();
  const card = db.gifts.shift();
  saveDB(db);
  return card || null;
};



jalaali.js




// Ù†Ø³Ø®Ù‡ Ø³Ø¨Ú© Ø´Ø¯Ù‡ jalaali-js
exports.toGregorian = function(shamsi) {
  const [y, m, d] = shamsi.split("/").map(Number);
  // Ø§ÛŒÙ†Ø¬Ø§ ÙØ±Ù…ÙˆÙ„ ØªØ¨Ø¯ÛŒÙ„ Ø¯Ù‚ÛŒÙ‚ Ù‚Ø±Ø§Ø± Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯
  return "2023-08-12"; // Ù†Ù…ÙˆÙ†Ù‡ Ø®Ø±ÙˆØ¬ÛŒ
};


ÙØ§ÛŒÙ„.  index.html

<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Apple ID Manager</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.json" />
</head>
<body>
  <div id="app"></div>
  <script src="app.js"></script>
  <script>
    if ("serviceWorker" in navigator)
      navigator.serviceWorker.register("./service-worker.js");
  </script>
</body>
</html>




ÙØ§ÛŒÙ„.  app.js


async function createOrder() {
  const name = document.querySelector("#name").value;
  const birth = document.querySelector("#birth").value;

  const res = await fetch("/create-order", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      name,
      shamsiBirth: birth,
      emailPrefix: name.toLowerCase()
    })
  });

  const data = await res.json();
  document.querySelector("#result").innerText = JSON.stringify(data.order, null, 2);
}


ÙØ§Ø¨Ù„.   style.css

body {
  font-family: sans-serif;
  padding: 20px;
  background: #f5f5f5;
}
input, button {
  padding: 12px;
  margin: 8px 0;
  width: 100%;
  font-size: 16px;
}



Ú¯ÛŒÙØª Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø¯Ø± ÙØ§ÛŒÙ„ db.json Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€Œ

{
  "gifts": [
    "XXXX-YYYY-ZZZZ-1",
    "XXXX-YYYY-ZZZZ-2",
    "XXXX-YYYY-ZZZZ-3"
  ],
  "orders": []
}


ğŸ”µ PWA Files

manifest.json

{
  "name": "Apple ID Manager",
  "short_name": "AppleID",
  "start_url": "./",
  "display": "standalone",
  "theme_color": "#ffffff",
  "background_color": "#ffffff",
  "icons": []
}



service-worker.js  ÙØ§ÛŒÙ„

self.addEventListener("install", e => {
  self.skipWaiting();
});

self.addEventListener("fetch", () => {});



Ø³Ø§Ø®ØªØ§Ø± Ù†Ù‡Ø§ÛŒÛŒ Ù¾Ø±ÙˆÚ˜



/
â”œâ”€â”€ index.html
â”œâ”€â”€ style.css
â”œâ”€â”€ script.js
â”œâ”€â”€ server.js
â”œâ”€â”€ db.json
â”œâ”€â”€ gift-pool.json
â”œâ”€â”€ package.json
â””â”€â”€ manifest.json




ï¿½ 1) ÙØ§ÛŒÙ„ package.json



{
  "name": "appleid-manager",
  "version": "1.0.0",
  "main": "server.js",
  "scripts": {
    "start": "node server.js"
  },
  "dependencies": {
    "express": "^4.18.2",
    "cors": "^2.8.5",
    "body-parser": "^1.20.2",
    "moment": "^2.30.1",
    "moment-jalaali": "^0.9.6"
  }
}



ğŸ“Œ 2) server.js â€” Ø¨Ú©â€ŒØ§Ù†Ø¯ Ú©Ø§




